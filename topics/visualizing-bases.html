<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to visualize the BFE bases used to make your coefficients &mdash; EXP 0.172 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=9c6809b7"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=5eb1bb1e"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to generate coefficients from phase-space snapshots" href="making-coefficients.html" />
    <link rel="prev" title="Are there pre-compiled versions of pyEXP and EXP?" href="../faq.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EXP
              <img src="../_static/exp_logo_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                7.x
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/overview.html">EXP at a glance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/install.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/tutorial.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EXP concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="bfetheory.html">BFE theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="codeintro.html">Code intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="timesseries.html">BFE time series analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="multistep.html">N-Body optimization in EXP</a></li>
<li class="toctree-l1"><a class="reference internal" href="centering.html">Centering</a></li>
<li class="toctree-l1"><a class="reference internal" href="yamlconfig.html">What is YAML?</a></li>
<li class="toctree-l1"><a class="reference internal" href="yamlconfig.html#an-annotated-exp-yaml-configuration">An annotated EXP YAML configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtosim.html">How to run your own N-body simulation in EXP</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Frequently Asked Questions (FAQ)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Are there pre-compiled versions of pyEXP and EXP?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html#i-only-want-pyexp-do-i-need-c-to-compile-exp">I only want pyEXP, do I need C++ to compile EXP?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html#why-would-i-use-exp-rather-than-pyexp">Why would I use EXP rather than pyEXP?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html#what-hardware-do-i-need-to-run-exp-and-pyexp">What hardware do I need to run EXP and pyEXP?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html#how-do-i-restart-exp-from-a-checkpoint">How do I restart EXP from a checkpoint?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html#my-hpc-cluster-does-not-have-the-required-dependencies-what-are-my-options">My HPC cluster does not have the required dependencies.  What are my options?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html#can-i-run-exp-or-pyexp-in-a-container">Can I run EXP or pyEXP in a container?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html#i-got-a-seg-fault-now-what-do-i-do">I got a “seg fault”, now what do I do?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html#how-can-i-do-a-calculation-with-phase-space-in-pyexp">How can I do a calculation with phase space in pyEXP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html#what-do-these-parameters-mean">What do these parameters mean?</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to solve specific problems</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to visualize the BFE bases used to make your coefficients</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#a-spherical-basis">A spherical basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cylindrical-basis">Cylindrical basis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="making-coefficients.html">How to  generate coefficients from phase-space snapshots</a></li>
<li class="toctree-l1"><a class="reference internal" href="saving-coefficients.html">How to save and reuse your newly generated coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualizing-fields.html">How to convert your coefficients back to physical fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="make-movies.html">Making movies of your BFE field quantities</a></li>
<li class="toctree-l1"><a class="reference internal" href="using-mssa.html">How to use mSSA with your coefficient series in pyEXP</a></li>
<li class="toctree-l1"><a class="reference internal" href="orbits.html">Generating orbits in your BFE potential fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="replay.html">Replaying a simulation using EXP</a></li>
<li class="toctree-l1"><a class="reference internal" href="exp-phase-space.html">The EXP phase-space format</a></li>
<li class="toctree-l1"><a class="reference internal" href="EXP-output.html">How the EXP N-body code selects what and when to write data</a></li>
<li class="toctree-l1"><a class="reference internal" href="flatdisk.html">How to configure a razor-thin disk</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug.html">Debugging EXP</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extending EXP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="design.html">Software design goals and features</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html#overall-organization-of-the-code">Overall organization of the code</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html#parallel-usage">Parallel usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="usermodules.html">User modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="newforces.html">How to make a new EXP force</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More about EXP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../news.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to EXP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doxygen.html">Index to C++ classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pybind11.html">Index to pyEXP classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versioning.html">Versioning and API stability</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EXP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">How to visualize the BFE bases used to make your coefficients</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/topics/visualizing-bases.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="how-to-visualize-the-bfe-bases-used-to-make-your-coefficients">
<span id="visualizing-bases"></span><h1>How to visualize the BFE bases used to make your coefficients<a class="headerlink" href="#how-to-visualize-the-bfe-bases-used-to-make-your-coefficients" title="Link to this heading"></a></h1>
<p>This is easy with pyEXP.  Each of the three main basis types supported
by pyEXP, <code class="docutils literal notranslate"><span class="pre">SphericalSL</span></code>, <code class="docutils literal notranslate"><span class="pre">Cylindrical</span></code>, and <code class="docutils literal notranslate"><span class="pre">FlatDisk</span></code> provides
a <code class="docutils literal notranslate"><span class="pre">getBasis</span></code> member function that returns the basis functions in
their native geometry.</p>
<p>Let’s work a few simple examples to give you all you need to look at
your bases.  A Jupyter notebook implementing these examples,
<code class="docutils literal notranslate"><span class="pre">viewing_a_basis.ipynb</span></code>, is available in the <a class="reference external" href="https://github.com/EXP-code/pyEXP-examples">pyEXP examples repository</a> in the
<cite>Tutorials/Basis</cite> directory.</p>
<section id="a-spherical-basis">
<h2>A spherical basis<a class="headerlink" href="#a-spherical-basis" title="Link to this heading"></a></h2>
<p id="visualizing-spherical-basis">Start with a simple configuration file for spherical basis and
instantiate the basis:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the halo basis config</span>
<span class="n">halo_config</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">---</span>
<span class="s2">id: sphereSL</span>
<span class="s2">parameters :</span>
<span class="s2">  numr:  2000                  # number of radial grid points</span>
<span class="s2">  rmin:  0.0001                # smallest radial grid point</span>
<span class="s2">  rmax:  1.95                  # largest radial grid point</span>
<span class="s2">  Lmax:  4                     # maximum spherical harmonic degree</span>
<span class="s2">  nmax:  10                    # maximum radial order</span>
<span class="s2">  rmapping: 0.0667             # radius for coordinate mapping</span>
<span class="s2">  modelname: SLGridSph.model   # model file name</span>
<span class="s2">...</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="n">halo_basis</span> <span class="o">=</span> <span class="n">pyEXP</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">Basis</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">halo_config</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">getBasis</span></code> member for each basis returns a vector of arrays for
the basis functions on the grid you have defined.  For the spherical
or flat disk case, the basis functions are one-dimensional functions.
We provide a beginning and ending radius in logarithmic units along
with a grid size:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the basis grid</span>
<span class="c1">#</span>
<span class="n">lrmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span>
<span class="n">lrmax</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">rnum</span>  <span class="o">=</span> <span class="mi">200</span>
<span class="n">halo_grid</span> <span class="o">=</span> <span class="n">halo_basis</span><span class="o">.</span><span class="n">getBasis</span><span class="p">(</span><span class="n">lrmin</span><span class="p">,</span> <span class="n">lrmax</span><span class="p">,</span> <span class="n">rnum</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that we have the basis function grids, we can plot them.  For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a logarithmically spaced grid in radius</span>
<span class="c1">#</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lrmin</span><span class="p">,</span> <span class="n">lrmax</span><span class="p">,</span> <span class="n">rnum</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">halo_grid</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">n</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;n=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;potential&#39;</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;l=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The resulting images are:</p>
<a class="reference internal image-reference" href="../_images/sph_basis_0.png"><img alt="figure showing the 1-d halo basis functions for l=0" class="align-center" src="../_images/sph_basis_0.png" style="width: 400.0px; height: 300.0px;" /></a>
<a class="reference internal image-reference" href="../_images/sph_basis_1.png"><img alt="figure showing the 1-d halo basis functions for l=1" class="align-center" src="../_images/sph_basis_1.png" style="width: 400.0px; height: 300.0px;" /></a>
<a class="reference internal image-reference" href="../_images/sph_basis_2.png"><img alt="figure showing the 1-d halo basis functions for l=2" class="align-center" src="../_images/sph_basis_2.png" style="width: 400.0px; height: 300.0px;" /></a>
</section>
<section id="cylindrical-basis">
<h2>Cylindrical basis<a class="headerlink" href="#cylindrical-basis" title="Link to this heading"></a></h2>
<p id="visualizing-cylindrical-basis">Now let’s do the same for a cylindrical basis.  The main difference
here is that the basis functions are two-dimensional meriodinal planes.</p>
<p>As before let’s begin by configuring and instantiating our basis:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the disk basis config</span>
<span class="c1">#</span>
<span class="n">disk_config</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">---</span>
<span class="s2">id: cylinder</span>
<span class="s2">parameters:</span>
<span class="s2">  acyl: 0.01                   # exponential disk scale length</span>
<span class="s2">  hcyl: 0.001                  # exponential disk scale height</span>
<span class="s2">  nmaxfid: 32                  # maximum radial order for spherical basis</span>
<span class="s2">  lmaxfid: 32                  # maximum harmonic order for spherical basis</span>
<span class="s2">  mmax: 6                      # maximum azimuthal order of cylindrical basis</span>
<span class="s2">  nmax: 8                      # maximum radial order of cylindrical basis</span>
<span class="s2">  ncylodd: 3                   # vertically anti-symmetric basis functions</span>
<span class="s2">  ncylnx: 256                  # grid points in radial direction</span>
<span class="s2">  ncylny: 128                  # grid points in vertical direction</span>
<span class="s2">  rnum: 200                    # radial quadrature knots for Gram matrix</span>
<span class="s2">  pnum: 0                      # azimuthal quadrature knots for Gram matrix</span>
<span class="s2">  tnum: 80                     # latitudinal quadrature knots for Gram matrix</span>
<span class="s2">  ashift: 0.5 #                # basis shift for variance generation</span>
<span class="s2">  vflag: 0                     # verbose output flag</span>
<span class="s2">  logr: false #                # logarithmically spaced radial grid</span>
<span class="s2">  density: false               # generate density basis functions</span>
<span class="s2">  eof_file: .eof.cache.run0    # EOF cache file name</span>
<span class="s2">...</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>The <cite>ncylodd</cite> parameters sets the number of vertically anti-symmetric
basis functions.  The first <cite>nmax-ncylodd</cite> basis functions are symmetric
and the last <cite>ncylodd</cite> are vertically anti-symmetric.  You can adjust
these parameters to provide the desired number of basis functions,
anticipating the degree of vertical symmetry.</p>
<p>We provide a beginning and ending cylindrical radius and a beginning
and ending vertical extent, this time in linear units (matching the <em>logr</em>
parameter given in the config):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the two-dimensional basis grid</span>
<span class="c1">#</span>
<span class="n">Rmin</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Rmax</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Rnum</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">Zmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.03</span>
<span class="n">Zmax</span> <span class="o">=</span>  <span class="mf">0.03</span>
<span class="n">Znum</span> <span class="o">=</span> <span class="mi">40</span>

<span class="n">disk_grid</span> <span class="o">=</span> <span class="n">disk_basis</span><span class="o">.</span><span class="n">getBasis</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span> <span class="n">Rmax</span><span class="p">,</span> <span class="n">Rnum</span><span class="p">,</span> <span class="n">Zmin</span><span class="p">,</span> <span class="n">Zmax</span><span class="p">,</span> <span class="n">Znum</span><span class="p">)</span>
</pre></div>
</div>
<p>We’ll use Pyplot’s <cite>contourf</cite> to visualize the meridional-plane basis
functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span> <span class="n">Rmax</span><span class="p">,</span> <span class="n">Rnum</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Zmin</span><span class="p">,</span> <span class="n">Zmax</span><span class="p">,</span> <span class="n">Znum</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">xv</span><span class="p">,</span> <span class="n">yv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
      <span class="c1"># Tranpose for contourf</span>
      <span class="n">cx</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">yv</span><span class="p">,</span> <span class="n">disk_grid</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;m, n=</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cx</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The first three of the resulting images are:</p>
<a class="reference internal image-reference" href="../_images/cyl_basis_0_0.png"><img alt="figure showing the 2-d cylindrical basis functions for m=0, n=0" class="align-center" src="../_images/cyl_basis_0_0.png" style="width: 400.0px; height: 300.0px;" /></a>
<a class="reference internal image-reference" href="../_images/cyl_basis_0_1.png"><img alt="figure showing the 2-d cylindrical basis functions for m=0, n=1" class="align-center" src="../_images/cyl_basis_0_1.png" style="width: 400.0px; height: 300.0px;" /></a>
<a class="reference internal image-reference" href="../_images/cyl_basis_0_2.png"><img alt="figure showing the 2-d cylindrical basis functions for m=0, n=2" class="align-center" src="../_images/cyl_basis_0_2.png" style="width: 400.0px; height: 300.0px;" /></a>
<p>The code above can be easily tweaked to produce only the vertically
antisymmetric basis functions.  Recall that the first <cite>nmax-ncylodd</cite>
are symmetric and the last <cite>ncylodd</cite> are vertically anti-symmetric.
In this case, <cite>nmax=8</cite> and <cite>ncylodd=3</cite>, so indices 5, 6, and 7 are
the vertically antisymmetric basis functions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span> <span class="n">Rmax</span><span class="p">,</span> <span class="n">Rnum</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Zmin</span><span class="p">,</span> <span class="n">Zmax</span><span class="p">,</span> <span class="n">Znum</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">xv</span><span class="p">,</span> <span class="n">yv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
      <span class="c1"># Tranpose for contourf</span>
      <span class="n">cx</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">yv</span><span class="p">,</span> <span class="n">disk_grid</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;m, n=</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cx</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The first three anti-symmetric basis functions are:</p>
<a class="reference internal image-reference" href="../_images/cyl_basis_0_5.png"><img alt="figure showing the 2-d cylindrical basis functions for m=0, n=5" class="align-center" src="../_images/cyl_basis_0_5.png" style="width: 400.0px; height: 300.0px;" /></a>
<a class="reference internal image-reference" href="../_images/cyl_basis_0_6.png"><img alt="figure showing the 2-d cylindrical basis functions for m=0, n=6" class="align-center" src="../_images/cyl_basis_0_6.png" style="width: 400.0px; height: 300.0px;" /></a>
<a class="reference internal image-reference" href="../_images/cyl_basis_0_7.png"><img alt="figure showing the 2-d cylindrical basis functions for m=0, n=7" class="align-center" src="../_images/cyl_basis_0_7.png" style="width: 400.0px; height: 300.0px;" /></a>
<p>We can visualize the basis for <code class="docutils literal notranslate"><span class="pre">FlatDisk</span></code> using the same steps as
<code class="docutils literal notranslate"><span class="pre">SphericalSL</span></code>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../faq.html" class="btn btn-neutral float-left" title="Are there pre-compiled versions of pyEXP and EXP?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="making-coefficients.html" class="btn btn-neutral float-right" title="How to generate coefficients from phase-space snapshots" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2025, EXP-code collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>